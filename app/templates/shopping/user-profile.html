<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>User Dashboard - E-commerce</title>

  <!-- Favicon -->
  <link rel="icon" href="{{ url_for('static', filename='images/favicon.ico') }}" type="image/x-icon" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Kannada:wght@400;700&display=swap" rel="stylesheet" />

  <!-- CSS SECTION -->
  <!-- Bootstrap CSS (local) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}" />
  <!-- DataTables CSS (local) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='cdn/dataTables/dataTables.dataTables.min.css') }}" />
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/shopping/profile.css') }}" />

  <!-- JS LIBRARIES SECTION (local) -->
  <!-- jQuery (local) -->
  <script src="{{ url_for('static', filename='cdn/dataTables/jquery-3.7.1.js') }}"></script>
  <!-- DataTables JS (local) -->
  <script src="{{ url_for('static', filename='cdn/dataTables/dataTables.min.js') }}"></script>
  <!-- Bootstrap Bundle JS (local) -->
  <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.bundle.min.js') }}"></script>

</head>

<body>
  <div class="container py-5">
    <div class="row gx-3">

      <!-- Sidebar -->
      <div class="col-md-3 mb-3">
        <div class="card shadow-sm border-0 h-100 d-flex flex-column">
          <div class="card-body text-center border-bottom">
            <div id="userAvatar"
              class="rounded-circle d-flex align-items-center justify-content-center text-white fw-bold mx-auto mb-3">
            </div>
            <h5 id="userNameDisplay" class="mb-0"></h5>
            <small id="userEmailDisplay" class="text-muted"></small>
          </div>
          <div class="list-group list-group-flush flex-grow-1">
            <a href="#profile" class="list-group-item list-group-item-action active" data-bs-toggle="tab">
              <i class="bi bi-person-lines-fill me-2"></i>Profile
            </a>
            <a href="#orders" class="list-group-item list-group-item-action" data-bs-toggle="tab">
              <i class="bi bi-box-seam me-2"></i>Orders
            </a>
            <a href="#address" class="list-group-item list-group-item-action" data-bs-toggle="tab">
              <i class="bi bi-geo-alt me-2"></i>Manage Address
            </a>
          </div>
          <div class="card-footer bg-light text-center">
            <button id="logoutBtn" class="btn btn-outline-danger w-100">
              <i class="bi bi-box-arrow-right me-1"></i> Logout
            </button>
          </div>
        </div>
      </div>

      <!-- Main content -->
      <div class="col-md-9">
        <div class="tab-content">

          <!-- Profile -->
          <div class="tab-pane fade show active" id="profile">
            <div class="card shadow-sm border-0">
              <div class="card-header bg-info text-white d-flex align-items-center">
                <h5 class="mb-0"><i class="bi bi-person-badge me-2"></i>Your Profile</h5>
              </div>
              <div class="card-body">
                <dl class="row mb-0">
                  <dt class="col-sm-3"><i class="bi bi-person-fill me-1"></i>Full Name</dt>
                  <dd class="col-sm-9" id="profileViewName"></dd>

                  <dt class="col-sm-3"><i class="bi bi-telephone-fill me-1"></i>Phone</dt>
                  <dd class="col-sm-9" id="profileViewPhone"></dd>

                  <dt class="col-sm-3"><i class="bi bi-envelope-fill me-1"></i>Email</dt>
                  <dd class="col-sm-9" id="profileViewEmail"></dd>

                  <dt class="col-sm-3"><i class="bi bi-gender-ambiguous me-1"></i>Gender</dt>
                  <dd class="col-sm-9" id="profileViewGender"></dd>

                  <dt class="col-sm-3"><i class="bi bi-calendar3 me-1"></i>Date of Birth</dt>
                  <dd class="col-sm-9" id="profileViewDOB"></dd>

                  <dt class="col-sm-3"><i class="bi bi-translate me-1"></i>Preferred Language</dt>
                  <dd class="col-sm-9" id="profileViewLanguage"></dd>

                  <dt class="col-sm-3"><i class="bi bi-clock-history me-1"></i>Last Login</dt>
                  <dd class="col-sm-9" id="profileViewLastLogin"></dd>
                </dl>
              </div>
              <div class="card-footer text-end bg-light">
                <button class="btn btn-info text-white" data-bs-toggle="modal" data-bs-target="#profileModal">
                  <i class="bi bi-pencil-square me-1"></i> Edit Profile
                </button>
              </div>
            </div>
          </div>

          <!-- Orders -->
          <div class="tab-pane fade" id="orders">
            <div class="card shadow-sm border-0">
              <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="bi bi-receipt me-2"></i>Your Orders</h5>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-hover align-middle mb-0" id="orderTable">
                    <thead class="table-light">
                      <tr>
                        <th>#</th>
                        <th><i class="bi bi-hash me-1"></i>Order ID</th>
                        <th><i class="bi bi-calendar-event me-1"></i>Date</th>
                        <th><i class="bi bi-flag me-1"></i>Status</th>
                        <th class="text-end"><i class="bi bi-currency-rupee me-1"></i>Total (INR)</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- Addresses -->
          <div class="tab-pane fade" id="address">
            <div class="card shadow-sm border-0">
              <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="bi bi-geo me-2"></i>Your Addresses</h5>
                <button class="btn btn-light btn-sm" data-bs-toggle="modal" data-bs-target="#addressModal">
                  <i class="bi bi-plus-lg me-1"></i> Add
                </button>
              </div>
              <div class="card-body" id="addressList"></div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- Address Modal -->
  <div class="modal fade" id="addressModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content shadow">
        <div class="modal-header bg-success text-white">
          <h5 class="modal-title"><i class="bi bi-geo-alt-fill me-2"></i>Add / Edit Address</h5>
          <button class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <form id="addressForm">
          <div class="modal-body">
            <input type="hidden" id="addressId" />

            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Recipient Name</label>
                <input id="recipientName" class="form-control" required />
              </div>

              <div class="col-md-6">
                <label class="form-label">Phone Number</label>
                <input id="phoneNumber" class="form-control" maxlength="15" required />
              </div>

              <div class="col-12">
                <label class="form-label">Address Line</label>
                <textarea id="addressText" class="form-control" rows="2" required></textarea>
              </div>

              <div class="col-md-4">
                <label class="form-label">Postal Code</label>
                <input id="addressPincode" class="form-control" required />
              </div>
              <div class="col-md-4">
                <label class="form-label">City / District</label>
                <input id="addressCity" class="form-control" required />
              </div>
              <div class="col-md-4">
                <label class="form-label">Taluk / Division</label>
                <input id="addressTaluk" class="form-control" />
              </div>

              <div class="col-md-4">
                <label class="form-label">State</label>
                <input id="addressState" class="form-control" required />
              </div>
              <div class="col-md-4">
                <label class="form-label">Country</label>
                <input id="addressCountry" class="form-control" value="India" required />
              </div>
              <div class="col-md-4">
                <label class="form-label">Address Type</label>
                <select id="addressType" class="form-select">
                  <option value="Home">Home</option>
                  <option value="Office">Office</option>
                  <option value="Other">Other</option>
                </select>
              </div>

              <div class="col-12">
                <label class="form-label">Delivery Instructions</label>
                <textarea id="deliveryInstructions" class="form-control" rows="2"></textarea>
              </div>

              <div class="col-md-6">
                <label class="form-label">Latitude</label>
                <input id="latitude" class="form-control" type="number" step="0.000001" />
              </div>
              <div class="col-md-6">
                <label class="form-label">Longitude</label>
                <input id="longitude" class="form-control" type="number" step="0.000001" />
              </div>

              <div class="col-12">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="isDefault" />
                  <label class="form-check-label" for="isDefault">Set as default address</label>
                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer">
            <button class="btn btn-light" data-bs-dismiss="modal" type="button">
              <i class="bi bi-x-lg me-1"></i>Cancel
            </button>
            <button type="submit" class="btn btn-success">
              <i class="bi bi-save me-1"></i>Save
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Profile Modal -->
  <div class="modal fade" id="profileModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content shadow-lg border-0">
        <div class="modal-header bg-info text-white">
          <h5 class="modal-title"><i class="bi bi-pencil-square me-2"></i>Edit Profile</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form id="profileForm">
          <div class="modal-body">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">Full Name</label>
                <input id="profileName" class="form-control" placeholder="John Doe" required />
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Phone</label>
                <input id="profilePhone" class="form-control" placeholder="+91 9876543210" required />
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Email</label>
                <input id="profileEmail" type="email" class="form-control" placeholder="example@email.com" disabled />
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Gender</label>
                <select id="profileGender" class="form-select">
                  <option value="">Select Gender</option>
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                  <option value="Other">Other</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Date of Birth</label>
                <input id="profileDOB" type="date" class="form-control" />
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Preferred Language</label>
                <input id="profileLanguage" class="form-control" placeholder="English" />
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light" data-bs-dismiss="modal">
              <i class="bi bi-x-lg me-1"></i>Cancel
            </button>
            <button type="submit" class="btn btn-info text-white">
              <i class="bi bi-save me-1"></i>Save Changes
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Order Details Modal -->
  <div class="modal fade" id="orderModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">Order Details</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <h6>Shipping Info:</h6>
          <p id="modalShippingInfo"></p>

          <h6>Items:</h6>
          <div class="table-responsive">
            <table class="table table-bordered" id="modalItemsTable">
              <thead class="table-light">
                <tr>
                  <th>#</th>
                  <th>Title</th>
                  <th>Author</th>
                  <th>Quantity</th>
                  <th>Price</th>
                  <th>Total</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <h6 class="mt-3">Order Summary:</h6>
          <p id="modalOrderSummary"></p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- APP JS -->
  <script type="module" src="{{ url_for('static', filename='js/shopping/profile.js') }}"></script>

  {% include 'customLoader.html' %}
  {% include 'footer.html' %}
</body>

</html>